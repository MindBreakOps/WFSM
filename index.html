<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://mindbreakops.github.io/WFSM/wfsm.png">
    <link rel="icon" type="image/png" href="https://mindbreakops.github.io/WFSM/wfsm.png">
    
    <title>W.F.S.M | Professional Assessment</title>

	<style>
	:root {
		--logo-teal: #12c2e9; --logo-red: #f64f59;
		--glass: rgba(255, 255, 255, 0.45); /* Transparent Glass */
		--text: #1d1d1f;
	}
	
	body {
		font-family: -apple-system, sans-serif;
		display: flex; justify-content: center; align-items: center;
		min-height: 100vh; margin: 0;
		/* RESTORED: Liquid Glass Animated Background */
		background: linear-gradient(135deg, #12c2e9, #c471ed, #f64f59);
		background-size: 400% 400%;
		animation: gradientFlow 15s ease infinite;
		color: var(--text);
	}
	
	@keyframes gradientFlow { 0% {background-position:0% 50%} 50% {background-position:100% 50%} 100% {background-position:0% 50%} }
	
	.container {
		text-align: center; 
		background: var(--glass);
		backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); /* Heavy Blurring Effect */
		padding: 2.5rem; 
		border-radius: 35px; 
		border: 1px solid rgba(255,255,255,0.3);
		max-width: 450px; width: 90%; 
		box-shadow: 0 8px 32px rgba(0,0,0,0.15);
	}
	
	.logo-img { 
		width: 95px; height: 95px; margin-bottom: 1.2rem; 
		border-radius: 24%; background: white; 
		object-fit: cover; /* FIXED: Logo fits border perfectly */
		box-shadow: 0 4px 15px rgba(0,0,0,0.1);
	}
	
	.page { display: none; }
	.page.active { display: block; animation: fadeIn 0.5s ease-out forwards; }
	@keyframes fadeIn { from {opacity:0; transform:scale(0.95);} to {opacity:1; transform:scale(1);} }
	
	input {
		padding: 16px; width: 85%; margin: 12px 0; border-radius: 14px;
		border: 1px solid rgba(0,0,0,0.1); 
		background: rgba(255,255,255,0.6);
		box-sizing: border-box; font-size: 1rem;
	}
	
	.btn-main {
		background: var(--logo-red); color: white; border: none;
		padding: 16px; width: 100%; border-radius: 16px;
		font-weight: 600; cursor: pointer; margin-top: 1rem;
		box-shadow: 0 4px 15px rgba(246, 79, 89, 0.3);
	}
	
	.category-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 25px; }
	.card { 
		background: rgba(255,255,255,0.3); 
		backdrop-filter: blur(5px);
		padding: 20px; border-radius: 22px; cursor: pointer; 
		border: 1px solid rgba(255,255,255,0.2);
		transition: all 0.3s ease;
	}
	.card:hover { background: white; transform: translateY(-5px); border-color: var(--logo-teal); }
	.card svg { width: 42px; height: 42px; }
	
	#certificate { 
		background: white; padding: 25px; border-radius: 25px; 
		position: relative; color: #000; text-align: center; 
		border: 1px solid rgba(0,0,0,0.05); 
	}
	.legit-stamp {
		position: absolute; bottom: 20px; right: 20px;
		border: 4px solid #d63031; color: #d63031; padding: 5px 15px;
		font-weight: 900; transform: rotate(-15deg); font-family: monospace;
		opacity: 0.8;
	}
	
	@media print {
		body { background: white; }
		.container { background: none; border: none; box-shadow: none; }
		.btn-main, footer, .logo-img, h1, .brief { display: none !important; }
		#certificate { display: block !important; border: 2px solid #000; }
	}
	</style>
</head>
<body>

	<div class="container">
		<img src="https://raw.githubusercontent.com/MindBreakOps/WFSM/main/wfsm.png" alt="Logo" class="logo-img">

		<div id="landing-page" class="page active">
			<h1>W.F.S.M</h1>
			<p class="brief">Congratulations on taking our professional assessment. Let's analyze your skills to find the perfect field for your future.</p>
			<input type="text" id="user-name" placeholder="Full Name">
			<input type="number" id="user-age" placeholder="Age">
			<button class="btn-main" onclick="goToSelection()">Start My Assessment</button>
		</div>

		<div id="selection-page" class="page">
			<h3>Select a Field</h3>
			<div class="category-grid" id="category-cards"></div>
		</div>

		<div id="quiz-page" class="page">
			<h2 id="question-text" style="font-size: 1.2rem; margin-bottom: 20px;"></h2>
			<div id="options-container"></div>
		</div>

		<div id="result-page" class="page">
			<div id="certificate">
				<img src="https://raw.githubusercontent.com/MindBreakOps/WFSM/main/wfsm.png" style="width:50px; border-radius:10px; margin-bottom: 10px;">
				<h2 style="margin: 5px 0; font-size: 1.2rem;">Official Certificate</h2>
				<p style="margin: 5px 0;">Awarded to <strong><span id="cert-name"></span></strong></p>
				<div style="font-size: 3.5rem; font-weight: 800; color: var(--logo-red); margin: 10px 0;" id="cert-percent">0%</div>
				<p style="margin: 5px 0;">Compatibility with <strong><span id="cert-cat"></span></strong></p>
				<p id="cert-verdict" style="font-size: 0.9rem; opacity: 0.8; margin-top: 10px;"></p>
				
				<div class="legit-stamp">LEGIT</div>
			</div>
			
			<p style="font-size: 0.9rem; margin-bottom: 20px; font-weight: 500;">
				"You have successfully analyzed your potential. We wish you the best in your career journey!"
			</p>
			
			<button class="btn-main" onclick="window.print()">Print Result</button>
			<button class="btn-main" style="background:rgba(0,0,0,0.05); color: #333;" onclick="location.reload()">Take Another Test</button>
		</div>

		<footer>Brought to you by MBOGL</footer>
	</div>

	<script>
		// PASTE YOUR NEW DEPLOYMENT URL HERE
		const API_URL = "https://script.google.com/macros/s/AKfycbx4TR9fhv8y-xIHEOoTMTiAExmSXZywmt_4mr50x6vhAeDEHQYNVZPrP6U4YH2EtHGeGQ/exec";

		let questions = {};
		let currentQuestionIndex = 0;
		let score = 0;
		let selectedInterest = '';
		let userData = { name: '', age: '' };

		const icons = {
			"Technology": `<svg viewBox="0 0 24 24" fill="none" stroke="#0575E6" stroke-width="1.5"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8M12 17v4"/></svg>`,
			"Business": `<svg viewBox="0 0 24 24" fill="none" stroke="#f64f59" stroke-width="1.5"><path d="M3 3v18h18"/><path d="M18 9l-5 5-3-3-4 4"/></svg>`,
			"Science": `<svg viewBox="0 0 24 24" fill="none" stroke="#12c2e9" stroke-width="1.5"><path d="M7 2v20M17 2v20M7 12h10M7 7h10M7 17h10"/></svg>`,
			"Health": `<svg viewBox="0 0 24 24" fill="none" stroke="#ff4b2b" stroke-width="1.5"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>`,
			"Art": `<svg viewBox="0 0 24 24" fill="none" stroke="#c471ed" stroke-width="1.5"><path d="M12 2a10 10 0 1 0 10 10c0-1.5-1-2.5-2.5-2.5h-1.5c-1.5 0-2.5-1-2.5-2.5v-1.5C15.5 3 14.5 2 13 2Z"/><circle cx="7.5" cy="10.5" r=".5"/><circle cx="10.5" cy="7.5" r=".5"/><circle cx="13.5" cy="11.5" r=".5"/></svg>`
		};

		window.onload = async () => {
			try {
				const response = await fetch(API_URL);
				questions = await response.json();
				renderCards();
			} catch (e) { 
				console.error("API Error");
				questions = {"Technology": [{"text":"Is the sheet connected?","options":["Yes","No","Maybe"],"answer":0}]};
				renderCards();
			}
		};

		function goToSelection() {
			const n = document.getElementById('user-name').value;
			const a = document.getElementById('user-age').value;
			if(!n || !a) { alert("Please enter both Name and Age."); return; }
			userData = { name: n, age: a };
			showPage('selection-page');
		}

		function renderCards() {
			const container = document.getElementById('category-cards');
			container.innerHTML = ''; 
			Object.keys(questions).forEach(cat => {
				const card = document.createElement('div');
				card.className = 'card';
				card.innerHTML = `${icons[cat] || '‚≠ê'} <br> <strong>${cat}</strong>`;
				card.onclick = () => startQuiz(cat);
				container.appendChild(card);
			});
		}

		function startQuiz(catName) {
			selectedInterest = catName; currentQuestionIndex = 0; score = 0;
			showPage('quiz-page'); showQuestion();
		}

		function showQuestion() {
			const q = questions[selectedInterest][currentQuestionIndex];
			document.getElementById('question-text').textContent = q.text;
			const box = document.getElementById('options-container');
			box.innerHTML = '';
			q.options.forEach((opt, idx) => {
				const b = document.createElement('button');
				b.className = 'btn-main'; b.style.background = "rgba(255,255,255,0.8)"; b.style.color = "#333";
				b.style.boxShadow = "none"; b.style.border = "1px solid rgba(0,0,0,0.05)";
				b.textContent = opt;
				b.onclick = () => {
					if(idx === q.answer) score += 5;
					currentQuestionIndex++;
					if(currentQuestionIndex < questions[selectedInterest].length) showQuestion();
					else finish();
				};
				box.appendChild(b);
			});
		}

		function finish() {
			showPage('result-page');
			const total = questions[selectedInterest].length * 5;
			const p = Math.round((score / total) * 100);
			const verdict = p >= 60 ? "Strong Compatibility Found." : "Alternative Paths Suggested.";

			document.getElementById('cert-name').textContent = userData.name;
			document.getElementById('cert-percent').textContent = p + "%";
			document.getElementById('cert-cat').textContent = "Field: " + selectedInterest;
			document.getElementById('cert-verdict').textContent = verdict;

			// UNIFIED GET UPLOAD: The most reliable way to bypass CORS and security blocks
			const finalUrl = API_URL + 
				"?name=" + encodeURIComponent(userData.name) +
				"&age=" + encodeURIComponent(userData.age) +
				"&category=" + encodeURIComponent(selectedInterest) +
				"&percentage=" + encodeURIComponent(p) +
				"&verdict=" + encodeURIComponent(verdict);

			// We use 'no-cors' so the browser doesn't block the request
			fetch(finalUrl, { mode: 'no-cors' });
		}

		function showPage(id) {
			document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
			document.getElementById(id).classList.add('active');
		}
	</script>
</body>
</html>
